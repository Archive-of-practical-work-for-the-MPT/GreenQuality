<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}GreenQuality Airlines{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/pages.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- –®–∞–ø–∫–∞ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –º—É—Ç–Ω–æ–≥–æ —Å—Ç–µ–∫–ª–∞ -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="{% static 'images/logo.png' %}" alt="GreenQuality Airlines Logo" style="height: 40px; margin-right: 15px; vertical-align: middle;">
                <h1 style="display: inline-block; vertical-align: middle;">GreenQuality Airlines</h1>
            </div>
            <nav class="navigation">
                <ul>
                    <li><a href="{% url 'index' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="{% url 'about' %}">–û –Ω–∞—Å</a></li>
                    <li><a href="{% url 'flights' %}">–†–µ–π—Å—ã</a></li>
                    <li><a href="{% url 'contacts' %}">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    {% if request.session.account_id %}
                        <li><a href="{% url 'profile' %}">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
                        {% if is_admin %}
                            <li><a href="{% url 'admin_panel' %}">–ü–∞–Ω–µ–ª—å</a></li>
                        {% elif is_manager %}
                            <li><a href="{% url 'manager_panel' %}">–ü–∞–Ω–µ–ª—å</a></li>
                        {% endif %}
                        <li><a href="{% url 'logout' %}">–í—ã—Ö–æ–¥</a></li>
                    {% else %}
                        <li><a href="{% url 'login' %}">–í—Ö–æ–¥</a></li>
                        <li><a href="{% url 'register' %}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
                    {% endif %}
                    <li>
                        <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                            <span class="theme-toggle-icon" id="themeIcon">üåô</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
    <main class="main-content">
        {% block content %}
        {% endblock %}
    </main>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>GreenQuality Airlines</h3>
                    <p>–í–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä –≤ –º–∏—Ä–µ –≤–æ–∑–¥—É—à–Ω—ã—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π.</p>
                </div>
                <div class="footer-section">
                    <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p>Email: info@greenquality.ru</p>
                    <p>–¢–µ–ª–µ—Ñ–æ–Ω: +7 (495) 123-45-67</p>
                </div>
                <div class="footer-section">
                    <h4>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–∞–º–∏</h4>
                    <div class="social-links">
                        <a href="#" class="social-icon">VK</a>
                        <a href="#" class="social-icon">Telegram</a>
                        <a href="#" class="social-icon">MAX</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 GreenQuality Airlines. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ -->
    <script>
        // –ö–∞—Ä—É—Å–µ–ª—å
        let currentSlide = 0;
        const slides = document.querySelectorAll('.carousel-item');
        const indicators = document.querySelectorAll('.indicator');
        
        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            indicators[currentSlide].classList.remove('active');
            
            currentSlide = (n + slides.length) % slides.length;
            
            slides[currentSlide].classList.add('active');
            indicators[currentSlide].classList.add('active');
        }
        
        function nextSlide() {
            showSlide(currentSlide + 1);
        }
        
        function prevSlide() {
            showSlide(currentSlide - 1);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏
        if (slides.length > 0) {
            slides[0].classList.add('active');
            if (indicators.length > 0) {
                indicators[0].classList.add('active');
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ —Å–ª–∞–π–¥–æ–≤ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            setInterval(nextSlide, 5000);
        }
        
        // FAQ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤
        document.addEventListener('DOMContentLoaded', function() {
            const faqQuestions = document.querySelectorAll('.faq-question');
            
            faqQuestions.forEach(question => {
                question.addEventListener('click', () => {
                    const answer = question.nextElementSibling;
                    question.classList.toggle('active');
                    answer.classList.toggle('open');
                });
            });
        });
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        (function() {
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const html = document.documentElement;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –∏–∑ localStorage
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                html.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
            } else {
                html.setAttribute('data-theme', 'light');
                themeIcon.textContent = 'üåô';
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
            themeToggle.addEventListener('click', function() {
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É
                themeIcon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            });
        })();

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        (function() {
            window.APP_URLS = {
                index: "{% url 'index' %}",
                about: "{% url 'about' %}",
                flights: "{% url 'flights' %}",
                contacts: "{% url 'contacts' %}",
                profile: "{% url 'profile' %}",
                admin_panel: "{% url 'admin_panel' %}",
                manager_panel: "{% url 'manager_panel' %}",
                export_csv: "{% url 'export_statistics' 'csv' %}",
                export_pdf: "{% url 'export_statistics' 'pdf' %}",
                login: "{% url 'login' %}",
                logout: "{% url 'logout' %}"
            };
            window.APP_USER = {
                is_authenticated: {{ is_authenticated|yesno:"true,false" }},
                is_admin: {{ is_admin|yesno:"true,false" }},
                is_manager: {{ is_manager|yesno:"true,false" }}
            };

            document.addEventListener('keydown', function(e) {
                // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –µ—Å–ª–∏ —Ñ–æ–∫—É—Å –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ (–∫—Ä–æ–º–µ Escape –∏ F1)
                const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : '';
                const inInput = tag === 'input' || tag === 'textarea' || tag === 'select';
                if (inInput && e.key !== 'Escape' && e.key !== 'F1') return;

                const ctrl = e.ctrlKey;
                const shift = e.shiftKey;
                const alt = e.altKey;
                const key = e.key.toUpperCase();

                // F1 ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –≥–æ—Ä—è—á–∏–º –∫–ª–∞–≤–∏—à–∞–º; Escape ‚Äî –∑–∞–∫—Ä—ã—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
                if (e.key === 'F1') {
                    e.preventDefault();
                    var hint = document.getElementById('hotkeys-hint');
                    if (hint) hint.classList.toggle('hotkeys-hint-visible');
                    return;
                }
                if (e.key === 'Escape') {
                    var hint = document.getElementById('hotkeys-hint');
                    if (hint) hint.classList.remove('hotkeys-hint-visible');
                    return;
                }

                // Ctrl+Shift+O ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
                if (ctrl && shift && key === 'O') {
                    e.preventDefault();
                    document.getElementById('themeToggle') && document.getElementById('themeToggle').click();
                    return;
                }

                // Ctrl+Shift+H ‚Äî –≥–ª–∞–≤–Ω–∞—è
                if (ctrl && shift && key === 'H') {
                    e.preventDefault();
                    window.location.href = APP_URLS.index;
                    return;
                }

                // Ctrl+Shift+F ‚Äî —Ä–µ–π—Å—ã
                if (ctrl && shift && key === 'F') {
                    e.preventDefault();
                    window.location.href = APP_URLS.flights;
                    return;
                }

                // Ctrl+Shift+P ‚Äî –ø—Ä–æ—Ñ–∏–ª—å (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
                if (ctrl && shift && key === 'P') {
                    e.preventDefault();
                    if (APP_USER.is_authenticated) {
                        window.location.href = APP_URLS.profile;
                    }
                    return;
                }

                // Ctrl+Shift+A ‚Äî –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
                if (ctrl && shift && key === 'A') {
                    e.preventDefault();
                    if (APP_USER.is_admin) {
                        window.location.href = APP_URLS.admin_panel;
                    }
                    return;
                }

                // Ctrl+Shift+M ‚Äî –ø–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)
                if (ctrl && shift && key === 'M') {
                    e.preventDefault();
                    if (APP_USER.is_manager) {
                        window.location.href = APP_URLS.manager_panel;
                    }
                    return;
                }

                // Ctrl+Shift+E ‚Äî —ç–∫—Å–ø–æ—Ä—Ç CSV (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)
                if (ctrl && shift && key === 'E') {
                    e.preventDefault();
                    if (APP_USER.is_manager) {
                        window.location.href = APP_URLS.export_csv;
                    }
                    return;
                }

                // Ctrl+Shift+L ‚Äî –≤—ã—Ö–æ–¥ (–µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
                if (ctrl && shift && key === 'L') {
                    e.preventDefault();
                    if (APP_USER.is_authenticated) {
                        window.location.href = APP_URLS.logout;
                    }
                    return;
                }
            });
        })();
    </script>
    <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –≥–æ—Ä—è—á–∏–º –∫–ª–∞–≤–∏—à–∞–º (F1) -->
    <div id="hotkeys-hint" class="hotkeys-hint" aria-hidden="true" onclick="if(event.target===this) this.classList.remove('hotkeys-hint-visible')">
        <div class="hotkeys-hint-content" onclick="event.stopPropagation()">
            <button type="button" class="hotkeys-hint-close" onclick="document.getElementById('hotkeys-hint').classList.remove('hotkeys-hint-visible')" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            <h3>–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h3>
            <ul class="hotkeys-list">
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>H</kbd> ‚Äî –ì–ª–∞–≤–Ω–∞—è</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>F</kbd> ‚Äî –†–µ–π—Å—ã</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>P</kbd> ‚Äî –ü—Ä–æ—Ñ–∏–ª—å</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>A</kbd> ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>M</kbd> ‚Äî –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>E</kbd> ‚Äî –≠–∫—Å–ø–æ—Ä—Ç (CSV, –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>L</kbd> ‚Äî –í—ã—Ö–æ–¥</li>
                <li><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>O</kbd> ‚Äî –¢–µ–º–∞ (—Å–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è)</li>
                <li><kbd>F1</kbd> ‚Äî —ç—Ç–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞</li>
            </ul>
        </div>
    </div>
    <style>
        .hotkeys-hint { position: fixed; inset: 0; z-index: 9999; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.5); opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s; }
        .hotkeys-hint.hotkeys-hint-visible { opacity: 1; visibility: visible; }
        .hotkeys-hint-content { background: var(--bg-color, #fff); border-radius: 16px; padding: 24px 32px; max-width: 400px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); position: relative; }
        .hotkeys-hint-close { position: absolute; top: 12px; right: 16px; background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-muted, #666); line-height: 1; }
        .hotkeys-hint-close:hover { color: var(--text-secondary, #333); }
        .hotkeys-hint h3 { margin: 0 0 16px 0; color: var(--text-secondary, #2c3e50); font-size: 20px; }
        .hotkeys-list { list-style: none; padding: 0; margin: 0; }
        .hotkeys-list li { padding: 6px 0; color: var(--text-secondary, #2c3e50); font-size: 14px; }
        .hotkeys-list kbd { display: inline-block; padding: 2px 8px; background: var(--bg-secondary, #f0f0f0); border-radius: 6px; font-family: inherit; font-size: 12px; margin: 0 2px; }
    </style>
    {% block extra_js %}{% endblock %}
</body>
</html>